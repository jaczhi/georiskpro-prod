System.register(["jimu-core","jimu-arcgis","jimu-ui","esri/widgets/Directions","esri/layers/RouteLayer"],(function(e,t){var i={},n={},o={},r={},a={};return{setters:[function(e){i.DataSourceManager=e.DataSourceManager,i.DataSourceStatus=e.DataSourceStatus,i.React=e.React,i.UtilityManager=e.UtilityManager,i.css=e.css,i.dataSourceUtils=e.dataSourceUtils,i.getAppStore=e.getAppStore,i.hooks=e.hooks,i.jsx=e.jsx},function(e){n.JimuMapViewComponent=e.JimuMapViewComponent},function(e){o.WidgetPlaceholder=e.WidgetPlaceholder,o.defaultMessages=e.defaultMessages},function(e){r.default=e.default},function(e){a.default=e.default}],execute:function(){e((()=>{var e={75465:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#000" fill-rule="evenodd" d="M1.414 10 10 1.414 18.586 10 10 18.586 1.414 10Zm-.707.707a1 1 0 0 1 0-1.414L9.293.707a1 1 0 0 1 1.414 0l8.586 8.586a1 1 0 0 1 0 1.414l-8.586 8.586a1 1 0 0 1-1.414 0L.707 10.707Zm14.19-2.041-3.314 3.352a9.065 9.065 0 0 0-.398-1.126l2.918-2.832.794.606ZM7.71 8H10V7H6v4h1V8.706l1.33 1.325C9.483 11.3 10 11.987 10 14.5v.5h1v-.5c.16-2.227-.537-3.43-1.948-5.16L7.71 8Z" clip-rule="evenodd"></path></svg>'},20404:e=>{"use strict";e.exports=a},35254:e=>{"use strict";e.exports=r},26826:e=>{"use strict";e.exports=n},48891:e=>{"use strict";e.exports=i},30726:e=>{"use strict";e.exports=o}},t={};function u(i){var n=t[i];if(void 0!==n)return n.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,u),o.exports}u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var i in t)u.o(t,i)&&!u.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.p="";var l={};return u.p=window.jimuConfig.baseUrl,(()=>{"use strict";u.r(l),u.d(l,{__set_webpack_public_path__:()=>I,default:()=>_});var e=u(48891),t=u(26826),i=u(30726),n=u(35254),o=u(20404);const r={includeDefaultSources:!1,locationEnabled:!1,maxSuggestions:6};function a(e){return`${e}_output_stop`}function s(e){return`${e}_output_direction_point`}function c(e){return`${e}_output_direction_line`}function d(e){return`${e}_output_route`}const v={_widgetLabel:"Directions"};var g=u(75465),f=u.n(g),p=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function u(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,u)}l((n=n.apply(e,t||[])).next())}))};const{useEffect:m,useState:y,useRef:h,useCallback:S,useMemo:w}=e.React,_=u=>{var l,g;const{config:_,id:C}=u,{searchConfig:I,routeConfig:j}=_,L=null===(l=u.theme)||void 0===l?void 0:l.darkTheme,A=null===(g=u.useMapWidgetIds)||void 0===g?void 0:g[0],[R,O]=y(null),k=h(null),T=h(null),E=h(null),V=e.hooks.useTranslation(v,i.defaultMessages),F=w((()=>V("findAddressOrPlace")),[V]),N=S((e=>{O(e)}),[]),J=S((()=>{var t,i,n;if(A&&(null==j?void 0:j.useUtility)&&(null===(i=null===(t=null==I?void 0:I.dataConfig)||void 0===t?void 0:t[0])||void 0===i?void 0:i.useUtility)){const t=null===(n=(0,e.getAppStore)().getState().appConfig)||void 0===n?void 0:n.utilities;return!!(t&&t[j.useUtility.utilityId]&&t[I.dataConfig[0].useUtility.utilityId])}return!1}),[A,null==j?void 0:j.useUtility,null==I?void 0:I.dataConfig]);return m((()=>{function t(){var e,t,i;if(null===(t=null===(e=T.current)||void 0===e?void 0:e.view)||void 0===t?void 0:t.map){const e=T.current.view.map.findLayerById(C);e&&R.view.map.remove(e),T.current.destroy()}k.current&&(k.current.innerHTML="");try{const e=null===(i=document.querySelector("calcite-panel.esri-save-layer"))||void 0===i?void 0:i.parentElement;e&&"CALCITE-POPOVER"===e.tagName.toUpperCase()&&document.body.removeChild(e)}catch(e){}}return J()&&(null==R?void 0:R.view)&&k.current?function(){var i,u,l,v;p(this,void 0,void 0,(function*(){t();const g=yield M(null==j?void 0:j.useUtility),f=yield function(e,t){var i,n,o;return p(this,void 0,void 0,(function*(){const a=Object.assign({},r),u=(null===(i=null==e?void 0:e.generalConfig)||void 0===i?void 0:i.hint)||t;if(u&&(a.allPlaceholder=u),"number"==typeof(null===(n=null==e?void 0:e.suggestionConfig)||void 0===n?void 0:n.maxSuggestions)&&(a.maxSuggestions=e.suggestionConfig.maxSuggestions),"boolean"==typeof(null===(o=null==e?void 0:e.suggestionConfig)||void 0===o?void 0:o.isUseCurrentLoation)&&(a.locationEnabled=e.suggestionConfig.isUseCurrentLoation),Array.isArray(null==e?void 0:e.dataConfig)){const i=e.dataConfig.map((e=>p(this,void 0,void 0,(function*(){const i={url:yield M(e.useUtility),name:e.label,placeholder:e.hint||t};return Promise.resolve(i)}))));yield Promise.all(i).then((e=>{a.sources=e}))}return Promise.resolve(a)}))}(I,F);if(!g||!(null===(u=null===(i=null==f?void 0:f.sources)||void 0===i?void 0:i[0])||void 0===u?void 0:u.url))return;const m=document.createElement("div");m.className="directions-container",L&&(m.className+=" dark-theme"),k.current.innerHTML="",k.current.appendChild(m);const y=new o.default({id:C,url:g});null===(v=null===(l=null==R?void 0:R.view)||void 0===l?void 0:l.map)||void 0===v||v.add(y),T.current=new n.default({id:C,layer:y,container:m,view:null==R?void 0:R.view,searchProperties:f}),T.current.viewModel.routeParameters.returnRoutes=!0,T.current.viewModel.routeParameters.returnDirections=!0,T.current.viewModel.routeParameters.returnStops=!0,b(C),E.current=T.current.watch("lastRoute",(()=>{T.current.lastRoute?function(t,i){var n,o,r;p(this,void 0,void 0,(function*(){try{const u=yield e.DataSourceManager.getInstance().createDataSource(a(t)),l=yield e.DataSourceManager.getInstance().createDataSource(d(t)),v=yield e.DataSourceManager.getInstance().createDataSource(s(t)),g=yield e.DataSourceManager.getInstance().createDataSource(c(t));yield U(u,"point",P(null===(n=i.stops)||void 0===n?void 0:n.toArray())),yield U(l,"polyline",P(i.routeInfo?[i.routeInfo]:[])),yield U(v,"point",P(null===(o=i.directionPoints)||void 0===o?void 0:o.toArray())),yield U(g,"polyline",P(null===(r=i.directionLines)||void 0===r?void 0:r.toArray())),D(u),D(l),D(v),D(g)}catch(e){console.log("Failed to create directions output data sources. ",e)}}))}(C,T.current.lastRoute):b(C)}))}))}():t(),()=>{var e;null===(e=E.current)||void 0===e||e.remove(),t()}}),[C,null==R?void 0:R.view,I,null==j?void 0:j.useUtility,F,J,L]),(0,e.jsx)("div",{className:"widget-directions jimu-widget"},J()?(0,e.jsx)(t.JimuMapViewComponent,{useMapWidgetId:A,onActiveViewChange:N}):(0,e.jsx)(i.WidgetPlaceholder,{widgetId:C,icon:f(),message:V("_widgetLabel")}),(0,e.jsx)("div",{ref:k,css:x}))},x=e.css`
  width: 100% !important;
  height: 100% !important;
  .directions-container{
    width: 100% !important;
    height: 100% !important;
    .esri-search{
      .esri-search__container{
        .esri-search__sources-button{
          z-index: 0;
          border-top: none;
          border-right: solid 1px var(--light-300);
          border-bottom: none;
          border-left: none;
          margin-right: 1px;
        }
        .esri-search__input-container{
          margin: auto;
          .esri-search__clear-button{
            z-index: 0;
            right: 4px;
          }
        }
      }
    }
    .esri-directions__panel-content{
      padding: 0 0 20px 0;
    }
    .esri-directions__add-stop-button{
      --calcite-ui-text-1: var(--dark);
    }
    &.dark-theme img.esri-directions__maneuver-icon{
      filter: invert(100%);
    }
  }
`;function M(t){return t?e.UtilityManager.getInstance().getUrlOfUseUtility(t).catch((e=>null)):Promise.resolve(null)}function b(t){return p(this,void 0,void 0,(function*(){try{const i=yield e.DataSourceManager.getInstance().createDataSource(a(t)),n=yield e.DataSourceManager.getInstance().createDataSource(d(t)),o=yield e.DataSourceManager.getInstance().createDataSource(s(t)),r=yield e.DataSourceManager.getInstance().createDataSource(c(t));C(i),C(n),C(o),C(r)}catch(e){console.log("Failed to create directions output data sources. ",e)}}))}function C(t){t&&(t.setStatus(e.DataSourceStatus.NotReady),t.setCountStatus(e.DataSourceStatus.NotReady))}function D(t){t&&(t.setStatus(e.DataSourceStatus.Unloaded),t.setCountStatus(e.DataSourceStatus.Unloaded))}function U(t,i,n){return p(this,void 0,void 0,(function*(){if(!t)return;const o=t.getSchema().fields[t.getIdField()],r=e.dataSourceUtils.changeJimuFieldsToJSAPIFields(t.getSchema().fields,o);yield t.updateSourceByFeatures(n,r,null==o?void 0:o.name,{id:t.id,geometryType:i})}))}function P(e){return e?e.map((e=>null==e?void 0:e.toGraphic())).filter((e=>!!e)):[]}function I(e){u.p=e}})(),l})())}}}));